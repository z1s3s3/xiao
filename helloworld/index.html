<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汽车</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .box {
            margin: auto;
            width: 950px;
            height: 500px;
            background-image: url("https://p1.ssl.qhmsg.com/t016bd8319c83f683ab.jpg");
        }

        tr {
            text-align: center;
        }

        .smallBox {
            margin: auto;
            width: 950px;
            background-image: url("https://p1.ssl.qhmsg.com/t016bd8319c83f683ab.jpg");
        }
    </style>
</head>

<body>
    <div class="box">
        <div class="smallBox">
            I d:<input type="text" id="id">&emsp;
            身份:<input type="text" id="idcard">&emsp;
            车名:<input type="text" id="name">&emsp;
            类型：<input type="text" id="type">
            年份:<input type="text" id="year">
            颜色:<input type="text" id="color">&emsp;
            图片:<input type="text" id="img">&emsp;
            创建时间:<input type="text" id="createTime">&emsp;
            更新时间:<input type="text" id="updateTime">&emsp;
        </div>
        <button type="button" class="btn btn-primary" id="addbtn" data-bs-toggle="modal" data-bs-target="#exampleModal">
            添加
        </button>
        <table class="table table-bordered border-primary" id="table-lis">
            <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">身份</th>
                    <th scope="col">车名</th>
                    <th scope="col">类型</th>
                    <th scope="col">年份</th>
                    <th scope="col">颜色</th>
                    <th scope="col">图片</th>
                    <th scope="col">创建时间</th>
                    <th scope="col">更新时间</th>
                    <th scope="col">删除时间</th>
                    <th scope="col">操作</th>
                </tr>
            </thead>
            <tbody></tbody>
    </div>
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    I d:<input type="text" id="id">&emsp;
                    身份:<input type="text" id="idcard">
                    车名:<input type="text" id="name">
                    类型:<input type="text" id="type">
                    年份:<input type="text" id="year">
                    颜色:<input type="text" id="color">
                    图片:<input type="text" id="img">
                    创建时间:<input type="text" id="createTime">
                    更新时间:<input type="text" id="updateTime">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" id="baocun">保存</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    I d:<input type="text" id="id">&emsp;
                    身份:<input type="text" id="idcard">
                    车名:<input type="text" id="name">
                    类型:<input type="text" id="type">
                    年份:<input type="text" id="year">
                    颜色:<input type="text" id="color">
                    图片:<input type="text" id="img">
                    创建时间:<input type="text" id="createTime">
                    更新时间:<input type="text" id="updateTime">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" id="baocun">保存</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        let date = [{
            id: '001',
            idcard: '1',
            brand: '奥迪',
            model: 'A4',
            year: '2019',
            color: '黑色',
            thumbnails: 'https://ts1.cn.mm.bing.net/th/id/R-C.9744215a07ef04776de238861958bf0b?rik=ALrfRVSEW%2b81fw&riu=http%3a%2f%2fcsimg.autotimes.com.cn%2fnews%2f2020%2f06%2f4930609_1339378978299847.jpg&ehk=DTJMen9xd2diJkoxvxvdIuUg%2bQ8slib6TMmUlpm5D3M%3d&risl=&pid=ImgRaw&r=0',
            createTime: '2021-04-01',
            updateTime: '2021-04-01',
            deleteTime: '2021-04-01'
        }, {
            id: '002',
            idcard: '2',
            brand: '奔驰',
            model: 'C200',
            year: '2019',
            color: '黑色',
            thumbnail: 'https://tse2-mm.cn.bing.net/th/id/OIP-C.pXyf3PCkrIPkQIdl9pCZfgHaEe?rs=1&pid=ImgDetMain',
            createTime: '2021-04-01',
            updateTime: '2021-04-01',
            deleteTime: '2021-04-01',
        }
        ]
        $(function () {
            renderTable()
        })
        // 添加
        $('#addbtn').click(function () {
            let id = $('#id').val()
            let idcard = $('#idcard').val()
            let name = $('#name').val()
            let type = $('#type').val()
            let year = $('#year').val()
            let author = $('#color').val()
            let img = $('#img').val()
            let createTime = $('#createTime').val()
            let updateTime = $('#updateTime').val()
            let data = {
                id,
                idcard,
                name,
                type,
                year,
                color,
                img,
                createTime,
                updateTime,
            }
            $.ajax({
                url: 'http://127.0.0.1:3000/api/user' + '/addCat',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "JSON",
                success: function (res) {
                    alert('添加成功')
                    renderTable()
                }
            })
        })
        // 保存
        $('#baocun').click(function () {
            let id = $('#id').val()
            let idcard = $('#idcard').val()
            let name = $('#name').val()
            let type = $('#type').val()
            let year = $('#year').val()
            let color = $('#color').val()
            let img = $('#img').val()
            let createTime = $('#createTime').val()
            let updateTime = $('#updateTime').val()
            let item = date.find(item => item.id === id);
            item.id = $('#id').val()
            item.idcard = $('#idcard').val()
            item.name = $('#name').val()
            item.type = $('#type').val()
            item.year = $('#year').val()
            item.color = $('#color').val()
            item.img = $('#img').val()
            item.createTime = $('#createTime').val()
            item.updateTime = $('#updateTime').val()
            renderTable();
            $('#baocun').hide();
        })
        // 修改
        $('tbody').on('click', '.edit', function () {
            $(id) = $(this).data('id')
            $(it) = date.find(item => item.id == id)
            $('#id').val(item.id)
            $('#idcard').val(item.idcard)
            $('#name').val(item.name)
            $('#type').val(item.type)
            $('#year').val(item.year)
            $('#color').val(item.color)
            $('#createTime').val(item.createTime)
            $('#updateTime').val(item.updateTime)
            $('.edit').click(function () {
                let id = $('#id').val()
                let name = $('#name').val()
                let type = $('#type').val()
                let price = $('#price').val()
                let stock = $('#stock').val()
                let description = $('#description').val()
                let data = {
                    id: id,
                    name: name,
                    type: type,
                    price: price,
                    stock: stock,
                    description: description,
                }
                $.ajax({
                    url: 'http://127.0.0.1:3000/api/user' + `/addCat?id=${id}`,
                    type: 'PUT',
                    data: data,
                    dataType: "JSON",
                    success: function (res) {
                        alert('修改成功');
                        gestSongs()
                        renderTable()
                    }
                })
            })
        })
        function renderTable() {
            $.ajax({
                url: 'http://127.0.0.1:3000/api/user' + '/list',
                type: "GET",
                success: function (res) {
                    let arr = res.list;
                    let html = '';
                    arr.forEach((item, index) => {
                        html += `<tr> 
                    <td>${item.id}</td>
                    <td>${item.idcard}</td>
                    <td>${item.brand}</td>
                    <td>${item.model}</td>
                    <td>${item.year}</td>
                    <td>${item.color}</td>
                    <td>${item.name}</td>
                    <td>${item.createTime}</td>
                    <td>${item.updateTime}</td>
                    <td>${item.deleteTime}</td>
                    <td>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop"
                        data-id="${item.id}" class="edit">
                            修改
                        </button>
                        </button>
                        <button type="button" class="btn btn-primary delete" data-id="${item.id}">删除</button>
                    </td>
                    </tr>`
                    })
                    $('tbody').html(html);
                    // 绑定删除按钮事件
                    $('.delete').click(function () {
                        let id = $(this).data('id');
                        if (confirm(`确认删除ID为${id}的数据吗？`)) {
                            $.ajax({
                                url: 'http://127.0.0.1:3000/api/user' + `/del?id=${id}`,
                                type: 'GET',
                                success: function (res) {
                                    alert('删除成功');
                                    renderTable();
                                }
                            })
                        }
                    })
                }
            })
        }
    </script>
</body>

</html>